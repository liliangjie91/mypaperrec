0引言在发电机组等大型回转机械状态监测与诊断中,常常利用轴系同一截面上两路相互垂直的振动信号合成轴心轨迹来监测其运行状态和故障类型。轴心轨迹直观地反映了转子瞬时运动状态,其形状和动态特性包含了丰富的故障征兆信息,在故障诊断中起着重要作用[1]。随着智能故障诊断技术的不断应用,对轴心轨迹进行自动识别和诊断成为故障诊断领域的发展趋势。但是工业现场往往环境嘈杂,采集的振动信号含有大量的噪声干扰,使合成的轴心轨迹复杂,形状模糊不清,无法进行自动识别,影响后续的故障诊断技术的使用。因此进行轴心轨迹提纯具有重要的实现意义,是发电机组故障诊断领域的一个重要研究方向。常规的轴心轨迹提纯方法就是信号去噪。为了消除振动信号的噪音并从受污染的信号中提纯轴心轨迹,低通滤波、小波分析、数学形态学等方法得到了广泛的应用。利用小波分析降噪原理提纯轴心轨迹,其基本思想是利用小波变换将原始信号分解到各个频带上,得到不同频带上的时间波形,再选取若干个频带来重构振动信号,实现信号的提纯。李舜酩[2]、张文斌[3]等利用谐波小波包变换的频段分析,对转子振动信号进行频域细化分析,实现了转子信号的轴心轨迹提取;张新江等利用信号与噪声的小波变换模极大值随尺度不同变化的特点进行消噪和达到对轴心轨迹的提纯的目的[4]。但是小波包分解一般都采用隔点采样的二进方式,这会造成数据量的减少及细节信号的丢失;并且小波包分解的结果存在着在各频带间能量的交叠问题,以及降噪效果也受到阈值选取的影响[3]。数学形态学(mathematical morphology)是基于随机集论建立起来的一种数学方法,它已被广泛应用于边缘检测、图象分割、形状识别、图像恢复与重建等图像处理问题中。基于数学形态学的形态滤波器是近年来出现的一种重要的非线性滤波器。通过数学形态变换能将一个复杂的信号分解为具有物理意义的各个部分,将其与背景剥离,同时保持信号主要的形状特征。文献[5]提出采用数学形态学滤波器对信号进行降噪和轨迹提纯,但存在无法有效滤除低频噪声的问题,且使用相同尺寸的形态结构元素将导致滤波器输出的严重偏倚[6]。针对上述轨迹提纯方法存在的缺陷,本文试图打破传统的轴心轨迹提纯方法,先去噪再合成净化轨迹的过程,直接在二维空间对轨迹图进行提纯;其思路是将二维空间中轴心轨迹图上的每个点看作一个粒子,通过粒子群运动对受污染的轴心轨迹进行提纯,然后反演振动信号,同时实现信号的降噪。这样就无需对轴心轨迹形状及振动信号特征有先验的知识,也不需要使用频谱分析和基函数构造等时–频方法,为实现振动信号去噪和轴心轨迹提纯提供一种新的解决思路。自从Kennedy提出粒子群优化(particle swarmoptimization,PSO)[7]算法以来,为了提高传统PSO的搜索效率,众多学者对基本算法进行了扩展,包括算法的改进、邻域拓扑结构设计、参数的选择、与其他进化算法的混合等。高海兵等人提出了一种广义粒子群算法[8-9],突破连续优化搜索模型,将粒子群算法推广到离散及组合优化领域,但是这种广义粒子群算法并没有突破传统PSO算法中所有粒子朝全局最优目标运动的模式。本文试图参照人类等群体的特性,结合案例提出一种单个粒子只认知自我目标,以及全体粒子合作实现全局目标的新的粒子群思想,本文也将其称为广义粒子群;并分析了这种新的广义粒子群优化方法用于解决轴心轨迹提纯问题的可行性。结合轴心轨迹提纯问题,建立了广义粒子群运动模型,阐述了这种广义粒子群的提纯和去噪机制,以及在外层对粒子群迭代进行控制的必要性和优点。最后给出了广义粒子群–模拟退火(simulated annealing algorithm,SAA)相结合的提纯去噪算法,并通过转子振动实验平台上的模拟实验分析验证算法的效果,表明这种广义粒子群方法是是一种有效的实现轴心轨迹提纯的新方法。1基本的粒子群优化算法粒子群优化[7]算法是一种从鸟群和鱼群活动中得到启发而模拟自然界生物集群现象的进化算法。该算法中一个粒子的位置代表待求解问题的一个解,这样的一群粒子模拟鱼群和鸟群的集群现象而进行移动,最后它们集中到某一个最优粒子附近,该粒子即作为问题的解。在每一次迭代中,粒子通过跟踪个体极值和全局极值来更新自己。PSO算法的数学过程表示如下。假定搜索的空间为n维,令nT表示粒子总数,第i个微粒位置向量表示为Xi(xi1,xi2,,xin),速度向量表示为Vi(vi1,vi2,,vin),粒子经历过的最好位置记为Pi(pi1,pi2,,pin),也称为Pibest。在群体中所有微粒经历过的最好位置的索引号用符号g表示,即Pg(pg1,pg2,,pgn),也称为gbest。PSO算法中每个粒子在迭代过程中按照如下两式对粒子的速度和位置进行更新:1 1 2 2Vi(k 1)Vi(k)c r[pi xi(k)]c r[p g xi(k)](1)X i(k 1)X i(k)Vi(k 1)(2)式中:k为进化代数;为惯性权系数;c1、c2为加速因子,也被称为认知因子和社会因子;r1、r2为[0,1]之间的随机数。在迭代过程中为了使粒子的速度不至过大,还需要对粒子的速度加以限制。该算法运行过程中粒子群的移动受到局部最优解和全局最优解的共同吸引,最后收敛到全局最优解。2新的广义粒子群优化方法2.1广义粒子群思想与轴心轨迹提纯如前所述,PSO算法是一种模拟自然界生物集群的优化方法,在算法中每个粒子能够感知整个群体的最优解,在运动过程中受到最优粒子的吸引,产生向其靠拢的趋势。但是考虑人类等社会性群体:如果将每个个体的人看作一个粒子,粒子的视野范围往往是有限的,无法感知整个群体,而只能受到自身周围的环境的影响并有跟从的心理;另外,与鱼和鸟觅食等过程不同,人类这一群体中每个粒子并没有认知整个群体的目标(全局最优解),相反的,粒子只有自己本身的目标(粒子最优解)。在一个著名的案例中,迪斯尼乐园的设计师利用游人群体的这一特性设计了迪斯尼公园的道路:迪斯尼公园中各景区之间全部铺满了草,让游人自己在草上自由的走动。于是草地上清晰地呈现出被人踩出的优雅自然的小道。这些小道,走的人多的地方就宽些,走的人少的地方就窄些。一年后迪斯尼乐园沿着人们自然踩出的痕迹修了路。在这一案例中,每个游人并没有对整个迪斯尼乐园的路径规划(全局目标)有所认识,而是在自己视野范围内跟从于周围环境而行动:路径越多的地方,人就走得越多;路径越窄的地方,人就越少走。同时,游人行走时的规律是朝着足迹最多的地方(个体目标)运动。在这些方式下,虽然游人的行动是无序的,但是通过群体的选择,构建了乐园中和谐自然的道路。该案例也表明,对于已经产生的道路,通过游人群体的共同作用,能够将走得多的道路自然而然地提取出来,而游人走得少的地方也就自然地消亡了。从该案例受到启发,本文根据游人这一群体的特性,提出一种广义的粒子群,该粒子群具有如下的特点:1)粒子的视野范围和运动范围有限;2)粒子受到周围环境的影响,具有跟从的心理;3)粒子只认知自己的最优解,对整个粒子群的最优解没有认识。与基本PSO算法不同,广义的粒子群通过所有个体的总和表现整体的性能。对该案例进一步拓展,则可以将上述的广义粒子群用于类似的道路提取问题中,通过群体的选择取得满意的效果。这一案例的探讨为轴心轨迹提纯问题的求解提供了新的思路。发电机组轴系上采集的两路振动信号X和Y轴信号如图1(a)所示。将其合成到X-Y平面上,得到图1(b)所示的轴心轨迹。由于采集的X和Y信号噪声较大,致使轴心轨迹模糊不清,影响后续判别。因此需要消除噪声,得到净化的轴心轨迹。如果将发电机组轴心轨迹中比作一条道路,轨迹图中的每个点看作一个粒子,各个粒子的迭代运动比作游人在当前位置的下一步行走,那么可以在已经生成的轴心轨迹基础上,通过粒子群的运动,构造一条粒子经过得最多的道路,也就是净化的轴心轨迹。下面将以此为目标,为轴心轨迹提纯问题建立粒子运动的模型。2.2广义粒子群运动建模在轴心轨迹图中,将轨迹图中的每个点看作一个粒子,则粒子的位置向量Xi(xi1,xi2)分别和图1 2002000 2000 1 2 3t/s(a)X、Y采样信号A/mA/mX/m(b)轴心轨迹Y/m 200 100 0 100 20015050 150 50图1 X、Y采样信号及合成的轴心轨迹Fig.1 Sample signals in X and Y directions,and the orbit所示的X、Y轴采样信号的同一时间轴上的点对应:12()()i ii ix x nx y n(3)粒子在轴心轨迹图中的每次运动,代表X、Y采样信号在相应点处幅值的相应调整。因此必须对粒子的运动范围进行限制,使X、Y采样信号不至于因粒子的运动而失真。由于轨迹图中粒子运动的本质是X,Y信号对应点的幅度调整,本文从信号分析的相关理论给出粒子运动范围的限制:根据HUANG等人提出的经验模式分解(empirical modedecomposition,EMD)方法的相关理论[10-11]以及谢启伟等[12]给出的解释,信号的每一点邻域是窄带信号,其本质特征是幅度符合局部的多项式调制,提取信号的基本模式分量(intrinsic mode function,IMF),也就是通过局部极值的多项式插值来拟合幅度调制的过程。那么对信号的每个点而言,由局部极值确定的上下包络线的均值为该点调制的幅度,上下包络线为该点幅度变化的范围。本文根据这一思想,参照EMD分解的方法,称X,Y信号中比两边值都小的点为局部极小值点,比两边都大的点为局部极大值点。分别对局部极大值点和局部极小值点进行样条插值,得到信号的上下包络xmax,xmin,ymax,ymin,则粒子Xi的运动范围受到如下的限制:min 1 maxmin 2 max()()()()i i ii iix n x x ny n x y n(4)可得到信号包络线的均值为xe(xmax xmin)/2,ye(ymax ymin)/2。给定粒子的初速度,使其初始时朝着均值的方向运动:Vi(0)[xe(ni)xi(0),ye(ni)yi(0)](5)本文提出的广义粒子群中,粒子具有视野受限且只认知自身目标的特性。因此,给定参数s作为粒子的视野范围。在此视野范围内,粒子朝着粒子群留下足迹最多的地方运动(类似于案例中游人朝着前人留下足迹最多的地方前进)。在本文中,对此做一定的简化,只保留当前粒子群的位置作为粒子群运动留下的足迹,而对以前时刻粒子群运动的轨迹不保留,以减少计算的复杂度。在此情况下,粒子运动的目标是使视野范围内的粒子个数最大化,其目标函数表示为1j iiX X sf(6)在基本PSO算法中粒子的运动受具有最好值的粒子的吸引,将粒子的这一特性称为社会性。而本文所描述的广义粒子群中粒子的社会性体现为从众心理,受视野范围内的其他粒子的共同作用,本文将其表述为引力:grave 3()j ij iiX X sj iX XgX X(7)上式的结果是一个向量,代表了粒子视野范围内所有粒子的共同作用下对该粒子产生的吸引力大小,其中grave称为引力因子。该表达式的意义在于当一群粒子共同运动时,粒子产生从众的心理,其运动受到了周围的影响。grave通常设置得较小,比如1 10 5左右;如果该参数值过大,表明群体对个体产生较大的影响,可能吸引个体偏离正常轨道,造成轨迹形状及信号失真。式(6)、(7)中的视野范围s需要根据粒子的分布情况设定合适的值:如果过大,则对个体产生影响的粒子群体分布范围太大,使个体运动失真,导致轨迹图形状也产生失真;如果过小,则个体只受到局部的影响,使个体无法从偏离位置运动到正常位置,影响轨迹模糊及信号噪声消除的效果。记粒子在运动过程中具有最好目标函数值的位置为pi,则粒子由惯性、自我认知、社会影响3部分决定其运动,其速度更新公式如下:1 1 2 2Vi(k 1)Vi(k)c r[pi xi(k)]c r g i(k)(8)其中第3项即式(7)所表示的引力项的作用。该式和传统PSO算法的式(1)具有类似的意义,c1、c2和选取可参考传统PSO算法。粒子的位置按照式(2)进行更新。由于粒子的运动范围受到式(4)限定,一旦粒子位置更新时范围超限,就使粒子在式(4)给定的矩形区域四壁内作碰撞反弹运动,使速度和碰撞前相反,大小不变。更新粒子的速度和位置后,需要同步更新式(3)所表示的X、Y信号中对应点的幅度以及fi,gi等项。尽管粒子并没有全局的认知,但是算法设计者(正如案例中的设计师)期望粒子群中每个粒子自身目标的总和最大,这也体现了广义粒子群通过所有个体的总和表现整体性能的特点。给出全局目标函数如下:Tgoal1niif(9)2.3广义粒子群方法提纯和去噪机制分析在上述模型中,轨迹提纯和信号去噪同步进行的,即粒子在轴心轨迹图中的每次位置更新,X、Y采样信号中相应点的幅值也作对应调整。一般而言,工业现场采集的振动信号主要含有白噪声和尖峰脉冲噪声这两类噪声。在前者的作用下,采集信号中的点在理想值周围波动;在合成的轴心轨迹上,相应点也是分布在理想的轴心轨迹的周围,示意图如图2所示。在后者作用下轴心轨迹中有少部分粒子远离理想的轴心轨迹,从群体的角度而言该部分粒子已经偏离了正常轨迹和群体,因此自我认知心理较强,而对群体的认知心理很低,本文将其称为“坏粒子”。根据式(6)—(8),在粒子的视野范围内,粒子趋向于向周围群体聚拢。则在理想的轨迹周围分布的粒子都向着理想的轨迹运动,并且越接近理想轨迹,粒子的目标函数就越大。更新采样信号中粒子Y/mX/m 150 50 5015015050 150 50图2只有白噪声时的轴心轨迹Fig.2 Rotor center’s orbit generatedby signals only with white noise对应的点,也会使该点趋向于理想值。由于轨迹图中绝大部分粒子分布在理想的轴心轨迹周围,因此可以得出如下结论:1)随着粒子群迭代进行,式(9)表示的全局目标函数不需要外加因素控制就有增加的趋势。2)单纯使用该方法可以有效实现轨迹提纯和信号去噪。尽管如此,这种广义粒子群方法并没有对全局目标进行控制的有效机制,且“坏粒子”可能会造成全局目标下降:在迭代过程中,群体的边缘有一些粒子和这些“坏的粒子”距离较近,运动过程受到这些“坏粒子”的影响。当群体的作用小于“坏粒子”的作用时,“边缘粒子”离群体越来越远,加入到“坏粒子”中,导致全局目标函数降低和轨迹提纯的效果减弱;反之,“边缘粒子”朝群体聚拢,吸引“坏粒子”也朝着群体的方向运动,达到预期的效果。在广义粒子群的迭代过程中,上述两种情况都有可能发生。与传统的PSO算法结合其他优化方法类似,可以将其他优化方法与广义粒子群方法相结合,通过在外层控制全局目标函数有效地防止“坏粒子”在进化过程中产生的消极作用,增强群体对“坏粒子”的吸引作用,保证轨迹净化和信号去噪的效果。因此下文将模拟退火算法和广义粒子群方法相结合,给出一种广义粒子群–模拟退火算法用于轴心轨迹提纯。3广义粒子群–模拟退火算法模拟退火算法[13]是一种模仿金属退火原理而提出的智能搜索算法,实现简单,只需控制迭代次数N、初始温度T(0)、马尔科夫链长度L等几个参数。该算法模仿金属退火的过程,在解空间搜索并以一定的概论接受差的解。退火过程中,每经过L次迭代更新一次温度,使接收概率随着温度降低而降低。随着迭代的进行,算法以概率1收敛到最优解。该算法已被证明是一种全局优化算法,且具有描述简单、使用灵活、运用广泛、运行效率高和较少受到初始条件约束等优点。本文中用SAA在外层控制粒子群的迭代:将粒子群的k次迭代作为SAA新解的产生方式,若SAA接受粒子群的k次迭代后的目标函数,则粒子群进入下一次迭代;否则粒子群退回到迭代前的状态,重新开始迭代。经过设定的退火次数后算法停止,即可得到净化后的轨迹。该算法的流程图如图3所示。粒子群和模拟退火参数设置及初始化粒子群进行k次迭代计算全局目标函数goal是否接收当前目标函数?接收当前粒子群状态作为下一次迭代的初始状态粒子群回到迭代前的初始状态,重新开始下一次迭代否是图3广义粒子群–模拟退火算法流程图Fig.3 Flow chart of generalized PSO-SAA algorithm4模拟测试实例分析4.1转子振动模拟试验平台简介为验证广义粒子群–模拟退火算法的提纯和去噪效果,本文在SUEPV-3型转子振动模拟试验台上进行模拟实验研究。SUEPV-3型转子振动模拟试验台如图4所示,该平台模拟发电机组等旋转机械运行情况,通过两路涡流传感器测量转子上X、Y测点的振动,可以通过改变转子转速、轴系刚度、质量不平衡、轴承的摩擦或冲击条件以及联轴节的型式来模拟机器的运行状态,有效地再现旋转机械所产生的多种振动现象。电动机转子I光电(键相)传感器底座联轴节外侧轴承座涡流传感器支架内侧轴承座涡流传感器安装孔转子II摩擦螺丝及支架图4转子振动模拟试验台Fig.4 Simulation test bed of rotor vibration4.2模拟测试实例1松动转轴支撑底座的螺丝以模拟发电机组的非转动部件配合松动故障。转子的转速为511.3 r/min,采样频率为1.090 8 kHz,实际采集的X、Y信号及合成的轴心轨迹如图5所示,数据长度为356 2点。X轴信号的频谱如图6所示。由于振动过程中没有产生啸叫等现象,则振动信号中不包含高频脉冲噪声。经过分析,噪声来源主要是振动过程自身和传感器的白噪声,导致轴心轨迹模糊。设置广义粒子群–模拟退火算法的参数如下:粒子群的引力因子grave=1 10 5,根据原始轴心轨迹图中粒子分布的范围设置视野范围s 3,与传统PSO算法类似,设置0.7,c1 c2 2;选择模拟退400 40t/s(a)X、Y采样信号A/mA/m0 1 2 3XYX/m(b)合成的轴心轨迹Y/m 40 20 0 20 404020 200 40图5采样信号及合成的轴心轨迹Fig.5 Probed signals and generated orbitA/mf/Hz0 40 80 12012840图6 X轴采样信号的频谱Fig.6 Spectral diagram in X direction火算法的退火次数NSAA 20,初始退火温度T(0)10 000,马尔可夫链长度L 5,温度更新公式T(k 1)T(k),0.5。按照图3所示的流程进行退火,退火过程中粒子群的迭代次数k 10,并且粒子群迭代过程按照式(2)及式(4)—(9)进行并更新个体及全局目标函数值。该算法运行过程中每次退火时目标函数变化如图7所示,得到净化的轴心轨迹图如图8所示。将图8和图5对比可看出,经过广义粒子群–oagl10/5 mt/s119750 4 8 12 16 20图7退火过程中目标函数变化Fig.7 Goal function changes during annealingY/mX/m 40 20 0 20 10 30图8净化后的轴心轨迹Fig.8 Purified orbit模拟退火算法提纯的轴心轨迹图比较清晰,效果非常明显。同时由图7可以看出,该算法运行过程中全局目标函数基本上是增加的,这也验证了2.3节的讨论,即信号中主要含有白噪声时,单独使用广义粒子群方法就可以实现轴心轨迹提纯。在图6的原始信号谱中,故障信息主要包含在1X,2X分量中,而白噪声的分布范围较广。如果使用低通滤波器,则无法兼顾保留1X,2X分量和滤除低于2X频率的低频噪声的要求,普通的滤波方式在这里无能为力;文献[5]中的数学形态学滤波器也存在无法有效滤除低频噪声分量和输出偏倚的问题。根据公式(3),轴心轨迹图上每一点分别和X、Y轴信号的同一时间轴上的点对应,改变轴心轨迹图上点的位置就相当于调整相应X、Y信号对应点处的幅值。因此,可根据净化后的轴心轨迹图反演振动信号,实现信号去噪。对图8所示的净化后的轴心轨迹反演X轴信号及其频谱,如图9所示。和图5、6对比可看出信号中包含的白噪声得到了有效的抑制,且信号没有失真、形变等偏倚现象。可见本文提出的方法在较大的频带范围内有效滤除了噪声,效果比形态学滤波和普通滤波器等传统方式更好。400 40t/s(a)X轴采样信号A/m0 1 2 3f/Hz(b)采样信号的频谱A/m0 40 80 120155100图9反演的X轴信号及其频谱Fig.9 Signal in X direction by inversion and its spectrum4.3模拟测试实例2不平衡是旋转机械最常见的故障[14]。为了模拟发电机组的转子不平衡故障,在转子模拟平台的转子孔内加装螺钉,造成转子质量不平衡。在转子转速为1406r/min时以采样频率2.9995kHz采集振动数据;同时为了仿真工业现场嘈杂环境带来的高频脉冲噪声,在MATLAB中编程对采集的信号人为地加入高频脉冲,得到如图10所示的轴心轨迹。和实例1相比,由于高频噪声的影响使轨迹图中更多的粒子偏离理想轨道。因此加大退火次数为30,其他参数和实例1中相同。进行轨迹提纯,得到如图11所示的提纯的轴心轨迹。从图12所示的Y/mX/m 100 60 20 20 60 1008040 400 80图10原始的轴心轨迹Fig.10 Originally probed orbit of rotor's centerY/mX/m 80 400 408040 400 80图11净化的轴心轨迹Fig.11 Purified orbit oagl10/5 mt/s0 10 20305.54.52.53.5图12退火过程目标函数变化Fig.12 Goal function changes during annealing退火过程中目标函数值的变化可以看出,在退火过程中由于“坏粒子”作用使目标函数值出现了下降,但是模拟退火算法能够收敛到全局最优解的特性克服了“坏粒子”的消极作用,取得了良好的净化效果。5结论本文针对发电机组的轴心轨迹提纯问题阐述了一种广义粒子思想,建立了广义粒子运动模型,将广义粒子群和模拟退火算法结合,提出了广义粒子群–模拟退火算法。将该算法用于轴心轨迹提纯,打破了传统的滤波再合成轨迹的提纯方式,直接在二维轴心轨迹上进行提纯,再反演振动信号。通过转子振动模拟试验台上的模拟实例研究验证了该算法的有效性和优越性。该方法实现简单,效果显著,有较好的实用价值,也为发电机组等旋转机械的轴心轨迹提纯和去噪提供了一个新的解决思路。
